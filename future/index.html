<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Past Present Past</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="HandheldFriendly" content="true">
		<meta name="author" content="Sophia Attigui">
		<meta name="description" content="Past present past">
		<meta name="keywords" content="Sophia Attigui, Sophia Att, Sophia Attigui design, Sophia Attigui graphic design, Sophia Attigui graphisme, Sophia Attigui work, Past Present Past">

		<style>

			body {
				font-family: 'Arial Narrow', sans serif;
				background-color: black;
				color: black;
				margin: 0 0 0 0;
				padding: 0 0 0 0;
				border: none;
/*				overflow: hidden;*/

			}


			* {

  				cursor: url(cursor.png) 29 9, auto;
			}

			::-moz-selection { 
    		color: yellow;
    		background: black;
			}

			::selection {
    		color: yellow;
    		background: black;
			}




@font-face {
  font-family: 'Arial Narrow';
  src: local(font name), url("ArialNarrow.ttf");
  src: url("ArialNarrow.eot");
  src:
       url("ArialNarrow.woff") format('woff'),
       url("ArialNarrow.ttf") format('truetype'),
       url("ArialNarrow.svg") format('svg'),
       url("ArialNarrow.eot") format('embedded-opentype');
  font-weight: normal;
  font-style: normal;
}

			
			#glFullscreen {
				width: 100%;
				height: 100vh;
				min-width: 640px;
				min-height: 360px;
				position: relative;
				overflow: hidden;
				z-index: 0;
			}

			.marquee {
				padding: 0;
				margin: 0;
			/*	background-color: yellow;*/
				color: red;
				font-size: 23px;
				position: fixed;
				top: 1%;
				z-index: 100;
				width: 100%;
			}

.marquee {
  margin: 0 auto;
  white-space: nowrap;
  overflow: hidden;
  box-sizing: border-box;

}

ul {
  position: absolute;
  font-family: helvetica;
  background-color: gray;
  color: yellow;
  column-rule: dotted 1px #333;
  list-style-type: none;
  font-size: 13px;
  top: 56px;
  left: 30px;
/*  padding-top: 3px;*/
/*  padding-bottom: 3px;*/
/*  background-color: gray;*/
/*  position: absolute;*/
/*  top: 68px;*/
/*  left: 50px;*/
  padding: 4px;
  padding-left: 6px;
  margin: 0;
  text-align: left;
  column-count: 4;
  list-style-type: none;
  z-index: 10000;
}



.marquee span {
  display: inline-block;
  padding-left: 100%;
  /* show the marquee just outside the paragraph */
  animation: marquee 	100s linear infinite;
}

.marquee span:hover {
  animation-play-state: paused
}


/* Make it move */

@keyframes marquee {
  0% {
    transform: translate(0, 0);
  }
  100% {
    transform: translate(-100%, 0);
  }
}


/*			.blink {
				width: 10px;
				height: 10px;
				background-color: red;
 				border-radius: 50%;
 				position: absolute;
 				z-index: 1000;

				top:0;
				bottom: 0;
				left: 0;
				right: 0;
				margin: auto;

				animation:fade 1000ms infinite;
    			-webkit-animation:fade 1000ms infinite;
	
			}*/

				/*	@media screen and (max-width: 450px) {
    			.blink {
				width: 15px;
				height: 15px;
    			}

    				}

			.blinkcontainer {
				background-color: transparent;
				width: 18px;
				height: 18px;
				z-index: 0;
				position: absolute;


				top:0;
				bottom: 0;
				left: 0;
				right: 0;
				margin: auto;
			}*/

/*	#hover-content {
    display:none;
    color: yellow;
    font-size: 14px;
}

.blinkcontainer:hover #hover-content {
    display:block;
}*/

/*.blinkcontainer .tooltiptext {
    visibility: hidden;
    width: 100px;
    font-size: 14px;
    color: black;
    background-color: gray;
    text-align: center;
    border-radius: 6px;
    padding: 4px 4px;
    position: absolute;
    z-index: 1;
    bottom: 190%;
    left: 50%;
    margin-left: -50px;
    opacity: 0;
    transition: opacity 1s;
}

.blinkcontainer:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
}*/




@keyframes fade {
    from { opacity: 1.0; }
    50% { opacity: 0.5; }
    to { opacity: 1.0; }
}                                                                                                                                                                                                                                  

@-webkit-keyframes fade {
    from { opacity: 1.0; }
    50% { opacity: 0.5; }
    to { opacity: 1.0; }
}


			#example {
				width: 100%;
				height: 100%;
				top: 0;
				left: 0;
				background-color: black;
				overflow: hidden;
				position: fixed;
			}

/*			#feedback {
				color: darkorange;
			}*/
			#dat {
				user-select: none;
				position: absolute;
				left: 0;
				top: 0;
				z-index: 200;
				overflow: hidden;
			}


			#about {
      			background-color: white;
				color: black;
      			border: black, 1px;
      			font-size: 14px;
				z-index: 200;	
				padding: 25px;			
				position: absolute;
				top: 70%;
				width: 120px;
			}

			#about:hover {
    			background-color: #ebe9e9;
			}


			#abouttext {
			display: block;
			position: fixed;
			width: 100%;
			height: auto;
			color: red;
			font-size: 45px;
			font-family: 'Times';
			background-color: #ebe9e9;
  			border: 1px solid black;
  			padding: 5px;
			}

					@media screen and (max-width: 450px) {
    			#abouttext {
				font-size: 15px;
    			}
    				}			


			#captions {
			display: block;
			position: relative;
			width: 100%;
			height: auto;
			color: yellow;
			font-size: 15px;
			font-family: 'Helvetica';
  			padding: 5px;
			}

					@media screen and (max-width: 450px) {
    			#captions {
				font-size: 13px;
    			}
    				}



			#links {
			display: block;
			position: relative;
			width: 100%;
			height: auto;
			color: yellow;
			font-size: 15px;
			font-family: 'Helvetica';
  			border: 1px solid black;
  			padding: 5px;
			}

					@media screen and (max-width: 450px) {
    			#links {
				font-size: 13px;
    			}
    				}			


  			.aboutsection {
  			position: absolute;
  			width: 100%;
  			height: auto;
  			top: 0px;
  			overflow-x: hidden;
  			display: none;
  			z-index: 20000;
			}

			.aboutsection img {
  			height: auto;
  			display: block;
			}

					@media screen and (max-width: 450px) {
    			.aboutsection img {
				width: 100%;
    			}
    				}



/*::-webkit-scrollbar {
    width: 12px;
    height: 14px
}

::-webkit-scrollbar-thumb {
    background: yellow;
}

::-webkit-scrollbar-track {
    background: black;
}*/


		</style>

	</head>

	<body>




		<div id="glFullscreen">
			<canvas id="example"></canvas>
		</div>

		<div id="dat"></div>

		<div class="marquee">




	<span>
What are you longing for when caught by the sentiment of nostalgia? Is it a place that you are longing for? Or a time? Is the sentiment of nostalgia an act of rebellion in itself? Is it another way of standing against the modern idea of time?  Is it the past you are longing for? Or is the actual unrealized dreams of the past? And where does tactility stand in the era of hyperconnectivity? Is there room for human interaction? Can we still imagine a cyberspace where you can evolve as an individual with your very own ambitions and interests while being part of an interconected mesh?
</marquee>

		</div>



<ul>
  <li>(three)</li>
  <li>two</li>
  <li>one</li>
</ul>


			<div class="blink"></div>
 
<!--  		<div id="hover-content">
        ZOOM IN
 		</div> -->
<div class="blinkcontainer">
 <!-- 		<div class="tooltip">Hover over me -->
  <span class="tooltiptext">try zooming in or scrolling down</span>
<!-- </div> -->
		</div>


		<div id="aboutbutton">
		<button id="about">what <br>is <br>this <br>about?</button>
		</div>

		<div class="aboutsection">

			<div id="abouttext"><!-- Keywords: Cyberspace, collective memory, imaginaire, phantasmagoria, ruins, mourning, non-return, escapism. <br> -->Past, present, past is a live performance and an interactive space installation to which is added this website. It is a sonic and tactile short journey into the spectrum of the dreamed of, the wished for and the longed for. </br></div>
			
<div class="truc">

			<div id="aboutimg">
			<img id="connect" src="connect1.png"/>	
			<img id="connect2" src="connect2.jpg"/>
			<img id="connect3" src="connect3.jpg"/>
			<img id="connect4" src="connect4.png"/>
			<img id="connect5" src="connect5.jpg"/>
			<img id="connect6" src="connect6.jpg"/>
			<img id="connect7" src="connect7.jpg"/>
			<img id="connect8" src="connect8.jpg"/>
			<img id="connect9" src="connect9.jpg"/>
			<img id="connect10" src="connect10.jpg"/>
			<img id="connect11" src="connect11.jpg"/>
			<img id="connect12" src="connect12.jpg"/>
			<img id="connect13" src="connect13.jpg"/>
			<img id="connect14" src="connect14.jpg"/>
			<img id="connect15" src="connect15.jpg"/>
			<img id="connect16" src="connect16.jpg"/>
			<img id="connect17" src="connect17.jpg"/>
			<img id="connect18" src="connect18.jpg"/>
			<img id="connect19" src="connect19.jpg"/>
			</div>

<div id="captions">
1. Still taken from ‘Rudolf Laban and the Geometry of Dance’ (2008)
<br>2. Allan Wrexler, ‘Coffee Seeks Its Own Level’ (1990)
<br>3. Listening station at Learning Resources Centre in Toronto (1969)
<br>4. Tehching Hsieh and Linda Montano, ‘Art/Life One Year Performance’ (1983-1984), performance documentation
<br>5. Studio Orta, ‘Connector mobile village III’, Robert Giffard Psychiatric Hospital, Quebec, Canada (2002)
<br>6. Kilim Carpet Weaving Technique Diagram
<br>7. Lygia Pape, ‘Divisor’, Hong Kong (1968-2013)
<br>8. Source unknown
<br>9. Anna Maria Maiolino, Por um fio, By a Thread, (1976)
<br>10. Filigran concrete diagram
<br>11. Lygia Clark, ‘Nostalgia do corpo—objetos relacionais’ (Nostalgia of the Body—Relational Objects), (1968-1988)
<br>12. Jungle Gym in Riverside Park in Manhattan
<br>13. Erwin Wurm, ‘One Minute Sculptures’, Taipei (2000)
<br>14. Issey Miyake, inaugural spring/summer 1999 A-POC runway show, École des Beaux-arts, Paris
<br>15. String game, source unknown
<br>16. Franz Erhard Walther, 'Sehkanal' (1968) 
<br>17. Pina Bausch, ‘Palermo Palermo’, Tanztheater Wuppertal Pina Bausch (2012)
<br>18. Rosemarie Trockel, 'Continental Divide' (1994)
<br>19. Alain Resnais, ‘L'année dernière à Marienbad’ (1961) 
<br>
<br>
Tracklist:
<br>1. Paul DeMarinis - Odd Evening
<br>2. Nico – Le petit chevalier
<br>3. Luc Ferrari – Danses Organiques 
<br>4. Broadcast & The Focus Group – A Seancing Song
<br>5. Dajuin Yao – Satisfaction of Oscillation 
<br>6. Annette Peacock – Did you hear me, Mommy?
<br>7. Zero Kama – Azure Lidded Woman (Pregnant Womb Of Non)
<br>8. Nobukazu Takemura – Mirrors in Mirror 
<br>9. Thantifaxath – Void Masquerading As Matter
<br>10. Sarah Hopkins – Kindred Spirits
<br>11. Silence the Tongues of Prophecy – Qubais Reed Ghazala
<br>12. Halim El-Dabh – Ta'abir Al-Zaar
<br>13. Geinoh Yamashirogumi – Doll's Polyphony
<br>14. Ghédalia Tazartès – Repas Froid (Part II)
<br>15. Robert Ashley – In Sara, Mencken, Christ and Beethoven there were men and women
</div>
</div>




<!-- <div id="links">
Blibliography
<br>Franco Berardi, After the future</br>
Patrice Flichy, The Internet Imaginaire
<br>Svetlana Boym, Nostalgia and its discontent</br> 
Svetlana Boym, The Future of nostalgia
<br>Stuart Tannock, Nostalgia critique</br>
Linda Hutcheon, Irony, Nostalgia and the Postmodern
<br>Mark Fisher, Ghosts of my life: Writings on depression, hauntology and lost futures</br>
Richard Brautigan, All Watched Over By Machines Of Loving Grace
<br>Sherry Turtle, Virtuality and its discontent</br>
Whole Earth Catalog 
<br></br>
Videography
<br>Svetlana Boym, Slow Thinking</br>
Adam Curtis, All watched over by Machines of Loving Grace
<br>Adam Curtis, Hypernormalisation</br>
A Communications Primer, Ray and Charles Eames
<br>We are Public</br>
	
</div> -->

		</div>

		<div id="feedback"></div>

  		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

		<script src="js/Detector.js"></script>
		<script src="../build/three.js"></script>
		<script src="js/controls/TrackballControls.js"></script>
		<script src="js/loaders/MTLLoader.js"></script>
		<script src="js/libs/dat.gui.min.js"></script>

		<script src="js/loaders/LoaderSupport.js"></script>
		<script src="js/loaders/OBJLoader2.js"></script>
		<script>

			


// $(window).scroll(function(){
//   var boxje = $(".blink").offset().top;
//   var value = 400;
//     if (boxje>value) {
//       $(".blink").css({"display":"none"});
//     } else {
//       $(".blink").css({"display":"initial"});
//     }
// });

			'use strict';

			var OBJLoader2Example = (function () {

				var Validator = THREE.LoaderSupport.Validator;

				function OBJLoader2Example( elementToBindTo ) {
					this.renderer = null;
					this.canvas = elementToBindTo;
					this.aspectRatio = 1;
					this.recalcAspectRatio();

					this.scene = null;
					this.cameraDefaults = {
						posCamera: new THREE.Vector3( 0.0, 175.0, 6000.0 ),
						posCameraTarget: new THREE.Vector3( 0, 0, 0 ),
						near: 0.1,
						far: 9000,
						fov: 45
					};
					this.camera = null;
					this.cameraTarget = this.cameraDefaults.posCameraTarget;

					this.controls = null;
				}

				OBJLoader2Example.prototype.initGL = function () {
					this.renderer = new THREE.WebGLRenderer( {
						canvas: this.canvas,
						antialias: true,
						autoClear: true
					} );
					this.renderer.setClearColor( 0x050505 );

					this.scene = new THREE.Scene();

					this.camera = new THREE.PerspectiveCamera( this.cameraDefaults.fov, this.aspectRatio, this.cameraDefaults.near, this.cameraDefaults.far );
					this.resetCamera();
					this.controls = new THREE.TrackballControls( this.camera, this.renderer.domElement );

					var ambientLight = new THREE.AmbientLight( 0x404040 );
					var directionalLight1 = new THREE.DirectionalLight( 0xC0C090 );
					var directionalLight2 = new THREE.DirectionalLight( 0xC0C090 );

					directionalLight1.position.set( -100, -50, 100 );
					directionalLight2.position.set( 100, 50, -100 );

					this.scene.add( directionalLight1 );
					this.scene.add( directionalLight2 );
					this.scene.add( ambientLight );

					// var helper = new THREE.GridHelper( 1200, 60, 0xFF4444, 0x404040 );
					// this.scene.add( helper );
				};

				OBJLoader2Example.prototype.initContent = function () {
					var modelName = 'floppy';
					this._reportProgress( { detail: { text: 'Loading: ' + modelName } } );

					var scope = this;
					var objLoader = new THREE.OBJLoader2();


					var callbackOnLoad = function ( event ) {
						scope.scene.add( event.detail.loaderRootNode );
						console.log( 'Loading complete: ' + event.detail.modelName );
						scope._reportProgress( { detail: { text: '' } } );
					};

					var onLoadMtl = function ( materials ) {
						objLoader.setModelName( modelName );
						objLoader.setMaterials( materials );
						objLoader.setLogging( true, true );
						objLoader.load( 'models/obj/female02/floppy.obj', callbackOnLoad, null, null, null, false );
					};
					objLoader.loadMtl( 'models/obj/female02/floppy.mtl', null, onLoadMtl );
				};

				OBJLoader2Example.prototype._reportProgress = function( event ) {
					var output = Validator.verifyInput( event.detail.text, '' );
					console.log( 'Progress: ' + output );
					document.getElementById( 'feedback' ).innerHTML = output;
				};

				OBJLoader2Example.prototype.resizeDisplayGL = function () {
					this.controls.handleResize();

					this.recalcAspectRatio();
					this.renderer.setSize( this.canvas.offsetWidth, this.canvas.offsetHeight, false );

					this.updateCamera();
				};

				OBJLoader2Example.prototype.recalcAspectRatio = function () {
					this.aspectRatio = ( this.canvas.offsetHeight === 0 ) ? 1 : this.canvas.offsetWidth / this.canvas.offsetHeight;
				};

				OBJLoader2Example.prototype.resetCamera = function () {
					this.camera.position.copy( this.cameraDefaults.posCamera );
					this.cameraTarget.copy( this.cameraDefaults.posCameraTarget );

					this.updateCamera();
				};

				OBJLoader2Example.prototype.updateCamera = function () {
					this.camera.aspect = this.aspectRatio;
					this.camera.lookAt( this.cameraTarget );
					this.camera.updateProjectionMatrix();
				};

				OBJLoader2Example.prototype.render = function () {
					if ( ! this.renderer.autoClear ) this.renderer.clear();
					this.controls.update();
// console.log( this );
// alert( 'sdfsd' )
					if ( this.camera !== undefined ) {
						this.camera.position.x += 0.5;
						// this.camera.position.y += 1;
					}
					this.renderer.render( this.scene, this.camera );


					// if ( this.camera.position.y < 100 ) {
     //  					$(".blinkcontainer").css({"display":"none"});
					// } else {
     //  					$(".blinkcontainer").css({"display":"initial"});
					// }	

					
					// if ( this.camera.position.y < 100 ) {
     //  					$(".blink").css({"display":"none"});
					// } else {
     //  					$(".blink").css({"display":"initial"});
					// }				
				};



				return OBJLoader2Example;

			})();

			var app = new OBJLoader2Example( document.getElementById( 'example' ) );

			var resizeWindow = function () {
				app.resizeDisplayGL();
			};

			var render = function () {
				requestAnimationFrame( render );
				app.render();
			};

			window.addEventListener( 'resize', resizeWindow, false );

			console.log( 'Starting initialisation phase...' );
			app.initGL();
			app.resizeDisplayGL();
			app.initContent();

			render();

			$( function( ) {

				$(".aboutsection > *").click(function(){
					$( this ).hide( );

					if ( !$( this ).siblings( ).is( ':visible' ) )
						$(".aboutsection" ).hide( );
					
				});
				
				$("#about").click( function( ){
					
					$(".aboutsection, .aboutsection > *" ).show();
					
				});
				
			});		


/**
 * StyleFix 1.0.3 & PrefixFree 1.0.7
 * @author Lea Verou
 * MIT license
 */

(function(){

if(!window.addEventListener) {
	return;
}

var self = window.StyleFix = {
	optIn: document.currentScript.hasAttribute("data-prefix"),

	link: function(link) {
		var url = link.href || link.getAttribute('data-href');
		try {
			// Ignore stylesheets with data-noprefix attribute as well as alternate stylesheets or without (data-)href attribute
			if(!url || link.rel !== 'stylesheet' || link.hasAttribute('data-noprefix')
				|| (self.optIn && !link.hasAttribute('data-prefix')) ) {
				return;
			}
		}
		catch(e) {
			return;
		}

		var base = url.replace(/[^\/]+$/, ''),
		    base_scheme = (/^[a-z]{3,10}:/.exec(base) || [''])[0],
		    base_domain = (/^[a-z]{3,10}:\/\/[^\/]+/.exec(base) || [''])[0],
		    base_query = /^([^?]*)\??/.exec(url)[1],
		    parent = link.parentNode,
		    xhr = new XMLHttpRequest(),
		    process;

		xhr.onreadystatechange = function() {
			if(xhr.readyState === 4) {
				process();
			}
		};

		process = function() {
				var css = xhr.responseText;

				if(css && link.parentNode && (!xhr.status || xhr.status < 400 || xhr.status > 600)) {
					css = self.fix(css, true, link);

					// Convert relative URLs to absolute, if needed
					if(css && base) {
						css = css.replace(/url\(\s*?((?:"|')?)(.+?)\1\s*?\)/gi, function($0, quote, url) {
							if(/^([a-z]{3,10}:|#)/i.test(url)) { // Absolute & or hash-relative
								return $0;
							}
							else if(/^\/\//.test(url)) { // Scheme-relative
								// May contain sequences like /../ and /./ but those DO work
								return 'url("' + base_scheme + url + '")';
							}
							else if(/^\//.test(url)) { // Domain-relative
								return 'url("' + base_domain + url + '")';
							}
							else if(/^\?/.test(url)) { // Query-relative
								return 'url("' + base_query + url + '")';
							}
							else {
								// Path-relative
								return 'url("' + base + url + '")';
							}
						});

						// behavior URLs shoudn’t be converted (Issue #19)
						// base should be escaped before added to RegExp (Issue #81)
						var escaped_base = base.replace(/([\\\^\$*+[\]?{}.=!:(|)])/g,"\\$1");
						css = css.replace(RegExp('\\b(behavior:\\s*?url\\(\'?"?)' + escaped_base, 'gi'), '$1');
						}

					var style = document.createElement('style');
					style.textContent = '/*# sourceURL='+link.getAttribute('href')+' */\n/*@ sourceURL='+link.getAttribute('href')+' */\n' + css;
					style.media = link.media;
					style.disabled = link.disabled;
					style.setAttribute('data-href', link.getAttribute('href'));

					if(link.id) style.id = link.id;

					parent.insertBefore(style, link);
					parent.removeChild(link);

					style.media = link.media; // Duplicate is intentional. See issue #31
				}
		};

		try {
			xhr.open('GET', url);
			xhr.send(null);
		} catch (e) {
			// Fallback to XDomainRequest if available
			if (typeof XDomainRequest != "undefined") {
				xhr = new XDomainRequest();
				xhr.onerror = xhr.onprogress = function() {};
				xhr.onload = process;
				xhr.open("GET", url);
				xhr.send(null);
			}
		}

		link.setAttribute('data-inprogress', '');
	},

	styleElement: function(style) {
		if (style.hasAttribute('data-noprefix')) {
			return;
		}
		var disabled = style.disabled;

		style.textContent = self.fix(style.textContent, true, style);

		style.disabled = disabled;
	},

	styleAttribute: function(element) {
		var css = element.getAttribute('style');

		css = self.fix(css, false, element);

		element.setAttribute('style', css);
	},

	process: function() {
		// Linked stylesheets
		$('link[rel="stylesheet"]:not([data-inprogress])').forEach(StyleFix.link);

		// Inline stylesheets
		$('style').forEach(StyleFix.styleElement);

		// Inline styles
		$('[style]').forEach(StyleFix.styleAttribute);
		
		var event = document.createEvent('Event');
		event.initEvent('StyleFixProcessed', true, true);
		document.dispatchEvent(event);

	},

	register: function(fixer, index) {
		(self.fixers = self.fixers || [])
			.splice(index === undefined? self.fixers.length : index, 0, fixer);
	},

	fix: function(css, raw, element) {
		if(self.fixers) {
		  for(var i=0; i<self.fixers.length; i++) {
			css = self.fixers[i](css, raw, element) || css;
		  }
		}

		return css;
	},

	camelCase: function(str) {
		return str.replace(/-([a-z])/g, function($0, $1) { return $1.toUpperCase(); }).replace('-','');
	},

	deCamelCase: function(str) {
		return str.replace(/[A-Z]/g, function($0) { return '-' + $0.toLowerCase() });
	}
};

/**************************************
 * Process styles
 **************************************/
(function(){
	setTimeout(function(){
		$('link[rel="stylesheet"]').forEach(StyleFix.link);
	}, 10);

	document.addEventListener('DOMContentLoaded', StyleFix.process, false);
})();

function $(expr, con) {
	return [].slice.call((con || document).querySelectorAll(expr));
}

})();

/**
 * PrefixFree
 */
(function(root){

if(!window.StyleFix || !window.getComputedStyle) {
	return;
}

// Private helper
function fix(what, before, after, replacement, css) {
	what = self[what];

	if(what.length) {
		var regex = RegExp(before + '(' + what.join('|') + ')' + after, 'gi');

		css = css.replace(regex, replacement);
	}

	return css;
}

var self = window.PrefixFree = {
	prefixCSS: function(css, raw, element) {
		var prefix = self.prefix;

		// Gradient angles hotfix
		if(self.functions.indexOf('linear-gradient') > -1) {
			// Gradients are supported with a prefix, convert angles to legacy
			css = css.replace(/(\s|:|,)(repeating-)?linear-gradient\(\s*(-?\d*\.?\d*)deg/ig, function ($0, delim, repeating, deg) {
				return delim + (repeating || '') + 'linear-gradient(' + (90-deg) + 'deg';
			});
		}

		css = fix('functions', '(\\s|:|,)', '\\s*\\(', '$1' + prefix + '$2(', css);
		css = fix('keywords', '(\\s|:)', '(\\s|;|\\}|$)', '$1' + prefix + '$2$3', css);
		css = fix('properties', '(^|\\{|\\s|;)', '\\s*:', '$1' + prefix + '$2:', css);

		// Prefix properties *inside* values (issue #8)
		if (self.properties.length) {
			var regex = RegExp('\\b(' + self.properties.join('|') + ')(?!:)', 'gi');

			css = fix('valueProperties', '\\b', ':(.+?);', function($0) {
				return $0.replace(regex, prefix + "$1")
			}, css);
		}

		if(raw) {
			css = fix('selectors', '', '\\b', self.prefixSelector, css);
			css = fix('atrules', '@', '\\b', '@' + prefix + '$1', css);
		}

		// Fix double prefixing
		css = css.replace(RegExp('-' + prefix, 'g'), '-');

		// Prefix wildcard
		css = css.replace(/-\*-(?=[a-z]+)/gi, self.prefix);

		return css;
	},

	property: function(property) {
		return (self.properties.indexOf(property) >=0 ? self.prefix : '') + property;
	},

	value: function(value, property) {
		value = fix('functions', '(^|\\s|,)', '\\s*\\(', '$1' + self.prefix + '$2(', value);
		value = fix('keywords', '(^|\\s)', '(\\s|$)', '$1' + self.prefix + '$2$3', value);

		if(self.valueProperties.indexOf(property) >= 0) {
			value = fix('properties', '(^|\\s|,)', '($|\\s|,)', '$1'+self.prefix+'$2$3', value);
		}

		return value;
	},

	prefixSelector: function(selector) {
		return self.selectorMap[selector] || selector
	},

	// Warning: Prefixes no matter what, even if the property is supported prefix-less
	prefixProperty: function(property, camelCase) {
		var prefixed = self.prefix + property;

		return camelCase? StyleFix.camelCase(prefixed) : prefixed;
	}
};

/**************************************
 * Properties
 **************************************/
(function() {
	var prefixes = {},
		properties = [],
		shorthands = {},
		style = getComputedStyle(document.documentElement, null),
		dummy = document.createElement('div').style;

	// Why are we doing this instead of iterating over properties in a .style object? Because Webkit.
	// 1. Older Webkit won't iterate over those.
	// 2. Recent Webkit will, but the 'Webkit'-prefixed properties are not enumerable. The 'webkit'
	//    (lower case 'w') ones are, but they don't `deCamelCase()` into a prefix that we can detect.

	var iterate = function(property) {
		if(/^-[^-]/.test(property)) {
			properties.push(property);

			var parts = property.split('-'),
				prefix = parts[1];

			// Count prefix uses
			prefixes[prefix] = ++prefixes[prefix] || 1;

			// This helps determining shorthands
			while(parts.length > 3) {
				parts.pop();

				var shorthand = parts.join('-');

				if(supported(shorthand) && properties.indexOf(shorthand) === -1) {
					properties.push(shorthand);
				}
			}
		}
	},
	supported = function(property) {
		return StyleFix.camelCase(property) in dummy;
	}

	// Some browsers have numerical indices for the properties, some don't
	if(style && style.length > 0) {
		for(var i=0; i<style.length; i++) {
			iterate(style[i])
		}
	}
	else {
		for(var property in style) {
			iterate(StyleFix.deCamelCase(property));
		}
	}

	// Find most frequently used prefix
	var highest = {uses:0};
	for(var prefix in prefixes) {
		var uses = prefixes[prefix];

		if(highest.uses < uses) {
			highest = {prefix: prefix, uses: uses};
		}
	}

	self.prefix = '-' + highest.prefix + '-';
	self.Prefix = StyleFix.camelCase(self.prefix);

	self.properties = [];

	// Get properties ONLY supported with a prefix
	for(var i=0; i<properties.length; i++) {
		var property = properties[i];

		if(property.indexOf(self.prefix) === 0) { // we might have multiple prefixes, like Opera
			var unprefixed = property.slice(self.prefix.length);

			if(!supported(unprefixed)) {
				self.properties.push(unprefixed);
			}
		}
	}

	// IE fix
	if(self.Prefix == 'Ms'
	  && !('transform' in dummy)
	  && !('MsTransform' in dummy)
	  && ('msTransform' in dummy)) {
		self.properties.push('transform', 'transform-origin');
	}

	self.properties.sort();
})();

/**************************************
 * Values
 **************************************/
(function() {
// Values that might need prefixing
var functions = {
	'linear-gradient': {
		property: 'backgroundImage',
		params: 'red, teal'
	},
	'calc': {
		property: 'width',
		params: '1px + 5%'
	},
	'element': {
		property: 'backgroundImage',
		params: '#foo'
	},
	'cross-fade': {
		property: 'backgroundImage',
		params: 'url(a.png), url(b.png), 50%'
	},
	'image-set': {
		property: 'backgroundImage',
		params: 'url(a.png) 1x, url(b.png) 2x'
	}
};


functions['repeating-linear-gradient'] =
functions['repeating-radial-gradient'] =
functions['radial-gradient'] =
functions['linear-gradient'];

// Note: The properties assigned are just to *test* support.
// The keywords will be prefixed everywhere.
var keywords = {
	'initial': 'color',
	'grab': 'cursor',
	'grabbing': 'cursor',
	'zoom-in': 'cursor',
	'zoom-out': 'cursor',
	'box': 'display',
	'flexbox': 'display',
	'inline-flexbox': 'display',
	'flex': 'display',
	'inline-flex': 'display',
	'grid': 'display',
	'inline-grid': 'display',
	'max-content': 'width',
	'min-content': 'width',
	'fit-content': 'width',
	'fill-available': 'width',
	'contain-floats': 'width'
};

self.functions = [];
self.keywords = [];

var style = document.createElement('div').style;

function supported(value, property) {
	style[property] = '';
	style[property] = value;

	return !!style[property];
}

for (var func in functions) {
	var test = functions[func],
		property = test.property,
		value = func + '(' + test.params + ')';

	if (!supported(value, property)
	  && supported(self.prefix + value, property)) {
		// It's supported, but with a prefix
		self.functions.push(func);
	}
}

for (var keyword in keywords) {
	var property = keywords[keyword];

	if (!supported(keyword, property)
	  && supported(self.prefix + keyword, property)) {
		// It's supported, but with a prefix
		self.keywords.push(keyword);
	}
}

})();

/**************************************
 * Selectors and @-rules
 **************************************/
(function() {

var
selectors = {
	':any-link': null,
	'::backdrop': null,
	':fullscreen': null,
	':full-screen': ':fullscreen',
	//sigh
	'::placeholder': null,
	':placeholder': ':placeholder-shown',
	'::input-placeholder': '::placeholder',
	':input-placeholder': ':placeholder-shown',
	':read-only': null,
	':read-write': null,
	'::selection': null
},

atrules = {
	'keyframes': 'name',
	'viewport': null,
	'document': 'regexp(".")'
};

self.selectors = [];
self.selectorMap = {};
self.atrules = [];

var style = root.appendChild(document.createElement('style'));

function supported(selector) {
	style.textContent = selector + '{}';  // Safari 4 has issues with style.innerHTML

	return !!style.sheet.cssRules.length;
}

for(var selector in selectors) {
	var standard = selectors[selector] || selector
	var prefixed = selector.replace(/::?/, function($0) { return $0 + self.prefix })
	if(!supported(standard) && supported(prefixed)) {
		self.selectors.push(standard);
		self.selectorMap[standard] = prefixed;
	}
}

for(var atrule in atrules) {
	var test = atrule + ' ' + (atrules[atrule] || '');

	if(!supported('@' + test) && supported('@' + self.prefix + test)) {
		self.atrules.push(atrule);
	}
}

root.removeChild(style);

})();

// Properties that accept properties as their value
self.valueProperties = [
	'transition',
	'transition-property',
	'will-change'
]

// Add class for current prefix
root.className += ' ' + self.prefix;

StyleFix.register(self.prefixCSS);


})(document.documentElement);




		</script>

	</body>

</html>
